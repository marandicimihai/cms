@page "/"
@attribute [Authorize]
@using CMS.Main.Abstractions.Notifications
@inject INotificationService NotificationService
@rendermode InteractiveServer

<PageTitle>Home</PageTitle>

<div class="flex flex-col gap-6">
    <div>
        <h1 class="text-2xl font-semibold text-neutral-100 mb-2">Hello, world!</h1>
        <p class="text-sm text-neutral-100">Welcome to your new app.</p>
    </div>

    <!-- Notification Testing Section -->
    <div class="rounded-xl border border-neutral-800 bg-gradient-to-b from-neutral-800 to-neutral-800/90 shadow-sm p-4">
        <h2 class="text-lg font-medium text-neutral-100 mb-4">Notification Testing</h2>
        
        <div class="flex flex-col gap-4">
            <!-- Basic Notifications -->
            <div>
                <h3 class="text-xs uppercase tracking-wide text-neutral-400 mb-2">Basic Notifications</h3>
                <div class="flex flex-wrap gap-2">
            <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-purple-500/0 hover:bg-gradient-to-tl hover:from-purple-500/20 hover:to-transparent hover:ring-1 hover:ring-purple-500/40 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                @onclick="ShowSuccess">
                        <span class="material-symbols-outlined icons-default text-base mr-2">check_circle</span>
                        Success
                    </button>
                    
            <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-rose-600/0 hover:bg-gradient-to-tl hover:from-rose-600/20 hover:to-transparent hover:ring-1 hover:ring-rose-600/40 focus:outline-none focus:ring-2 focus:ring-rose-600 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                @onclick="ShowError">
                        <span class="material-symbols-outlined icons-default text-base mr-2">error</span>
                        Error
                    </button>
                    
            <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-amber-500/0 hover:bg-gradient-to-tl hover:from-amber-500/20 hover:to-transparent hover:ring-1 hover:ring-amber-500/40 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                @onclick="ShowWarning">
                        <span class="material-symbols-outlined icons-default text-base mr-2">warning</span>
                        Warning
                    </button>
                    
            <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-purple-500/0 hover:bg-gradient-to-tl hover:from-purple-500/20 hover:to-transparent hover:ring-1 hover:ring-purple-500/40 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                @onclick="ShowInfo">
                        <span class="material-symbols-outlined icons-default text-base mr-2">info</span>
                        Info
                    </button>
                </div>
            </div>

            <!-- Long Messages -->
            <div>
                <h3 class="text-xs uppercase tracking-wide text-neutral-400 mb-2">Long Message Test</h3>
                <div class="flex flex-wrap gap-2">
            <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-purple-500/0 hover:bg-gradient-to-tl hover:from-purple-500/20 hover:to-transparent hover:ring-1 hover:ring-purple-500/40 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                @onclick="ShowLongMessage">
                        <span class="material-symbols-outlined icons-default text-base mr-2">description</span>
                        Long Message
                    </button>
                </div>
            </div>

            <!-- Multiple Notifications -->
            <div>
                <h3 class="text-xs uppercase tracking-wide text-neutral-400 mb-2">Multiple Notifications</h3>
                <div class="flex flex-wrap gap-2">
                    <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-purple-500/0 hover:bg-gradient-to-tl hover:from-purple-500/20 hover:to-transparent hover:ring-1 hover:ring-purple-500/40 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                            @onclick="ShowMultipleNotifications">
                        <span class="material-symbols-outlined icons-default text-base mr-2">notifications_active</span>
                        Show 3 Notifications
                    </button>
                    
                    <button type="button" 
                            class="inline-flex items-center justify-center rounded-full font-medium text-neutral-100 ring-0 ring-purple-500/0 hover:bg-gradient-to-tl hover:from-purple-500/20 hover:to-transparent hover:ring-1 hover:ring-purple-500/40 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 text-sm px-3 py-2"
                            @onclick="ShowNotificationSpam">
                        <span class="material-symbols-outlined icons-default text-base mr-2">list</span>
                        Show 5 Notifications
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private async Task ShowNotification(NotificationType type, string message)
    {
        await NotificationService.NotifyAsync(new Notification
        {
            Type = type,
            Message = message
        });
    }

    private async Task ShowMultipleNotifications()
    {
        await ShowNotification(NotificationType.Success, "First notification - Success!");
        await Task.Delay(300);
        await ShowNotification(NotificationType.Warning, "Second notification - Warning!");
        await Task.Delay(300);
        await ShowNotification(NotificationType.Info, "Third notification - Info!");
    }

    private async Task ShowNotificationSpam()
    {
        await ShowNotification(NotificationType.Info, "Notification 1 of 5");
        await Task.Delay(200);
        await ShowNotification(NotificationType.Success, "Notification 2 of 5 - Success!");
        await Task.Delay(200);
        await ShowNotification(NotificationType.Warning, "Notification 3 of 5 - Be careful!");
        await Task.Delay(200);
        await ShowNotification(NotificationType.Error, "Notification 4 of 5 - Error occurred!");
        await Task.Delay(200);
        await ShowNotification(NotificationType.Info, "Notification 5 of 5 - Done!");
    }

    // Helper methods to avoid quoting issues in attribute lambdas
    private Task ShowSuccess() => ShowNotification(NotificationType.Success, "Operation completed successfully!");
    private Task ShowError() => ShowNotification(NotificationType.Error, "An error occurred while processing your request.");
    private Task ShowWarning() => ShowNotification(NotificationType.Warning, "Please review your changes before saving.");
    private Task ShowInfo() => ShowNotification(NotificationType.Info, "You have 3 new messages.");
    private Task ShowLongMessage() => ShowNotification(NotificationType.Info, "This is a much longer notification message to test how the notification component handles text wrapping and maintains proper spacing and readability with extended content.");
}
